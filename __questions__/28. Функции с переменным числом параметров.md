
```c
int f(...);
```

- Во время компиляции компилятору не известны ни количество параметров, ни их типы. 
- Во время компиляции компилятор не выполняет никаких проверок.

НО список параметров функции с переменным числом аргументов совсем пустым быть не может.

```c
int f(int k, ...);
```

Напишем функцию, вычисляющую среднее арифметическое своих аргументов.
Проблемы:
1. Как определить адрес параметров в стеке?
2. Как перебирать параметры?
3. Как закончить перебор?

#### **Наивная реализация. Причина некорректной работы.**

По *cdecl* параметры в функцию передаются справа налево, т.е. можно получить адрес параметра так:

```c
double avg(int n, ...)
{
	int *p_i = &n;
	double *p_d = (double *) (p_i + 1);
	double sum = 0.0;
	if (!n)
		return 0.0;

	for (int i = 0; i < n; i++, p_d++)
		sum += *p_d;
	return sum / n;
}
```

Однако работать это не будет, так как аргументы могут передаваться с *выравниванием*.

#### **Стандартный способ работы с параметрами функций с переменным числом параметров - stdarg.h**

- va_list 
- void va_start(va_list argptr, last_param) 
- type va_arg(va_list argptr, type) 
- void va_end(va_list argptr)

```c
double avg(int n, ...)
{
	va_list vl;
	double sum = 0, num;
	if (!n)
		return 0.0;

	va_start(vl, n);
	for (int i = 0; i < n; i++)
	{
		num = va_arg(vl, double);
		printf("%lf\n", double);
		sum += num;
	}
	va_end(vl);
	return sum / n;
}
```